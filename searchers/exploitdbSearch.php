<?php

/**
 *
 */
class moduleExploitdb
{
	public $exploits=[];

  public function getXploits()
  {
    return $this->exploits;
  }
	public function run($service)
	{
		// echo "ANALIZANDO ".$service;
		$a = shell_exec("searchsploit -j ".$service);
		$inforry=json_decode($a, true);
		if (!empty($inforry["RESULTS_EXPLOIT"])) {
			// code..
			foreach ($inforry["RESULTS_EXPLOIT"] as $key => $value) {
				$this->exploits[]=$value;
			}

		}

	}
  public function runreadCsv($service)
  {
	    if (strlen($service) == 1) {
	    }else{
	    if (($gestor = fopen("repos/exploitdb/files_exploits.csv", "r")) !== FALSE) {
	        while (($datos = fgetcsv($gestor, 1000, ",")) !== FALSE) {
	            $numero = count($datos);
	            // echo $service;
	            if (stripos($datos[2], $service) !== false) {
	              $this->exploits[]=$datos;
	            }
	        }
	        fclose($gestor);
	    }
	  }
	}
}
?>
